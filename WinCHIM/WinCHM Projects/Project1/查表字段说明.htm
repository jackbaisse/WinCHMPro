<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>查表字段说明</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
html,body { 
	/* Default Font */
	font-family: Arial, Helvetica, sans-serif;
	font-size: 11pt;
}
</style>

</head>

<body>
<P>SELECT <BR>&nbsp;&nbsp;&nbsp; 表名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = case 
when a.colorder=1 then d.name else '' end,<BR>&nbsp;&nbsp;&nbsp; 
表说明&nbsp;&nbsp;&nbsp;&nbsp; = case when a.colorder=1 then isnull(f.value,'') 
else '' end,<BR>&nbsp;&nbsp;&nbsp; 字段序号&nbsp;&nbsp; = 
a.colorder,<BR>&nbsp;&nbsp;&nbsp; 字段名&nbsp;&nbsp;&nbsp;&nbsp; = 
a.name,<BR>&nbsp;&nbsp;&nbsp; 标识&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = case when 
COLUMNPROPERTY( a.id,a.name,'IsIdentity')=1 then '√'else '' 
end,<BR>&nbsp;&nbsp;&nbsp; 主键&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = case when 
exists(SELECT 1 FROM sysobjects where xtype='PK' and parent_obj=a.id and name in 
(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
SELECT name FROM sysindexes WHERE indid in( SELECT indid FROM sysindexkeys WHERE 
id = a.id AND colid=a.colid))) then '√' else '' end,<BR>&nbsp;&nbsp;&nbsp; 
类型&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = b.name,<BR>&nbsp;&nbsp;&nbsp; 占用字节数 = 
a.length,<BR>&nbsp;&nbsp;&nbsp; 长度&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 
COLUMNPROPERTY(a.id,a.name,'PRECISION'),<BR>&nbsp;&nbsp;&nbsp; 小数位数&nbsp;&nbsp; 
= isnull(COLUMNPROPERTY(a.id,a.name,'Scale'),0),<BR>&nbsp;&nbsp;&nbsp; 
允许空&nbsp;&nbsp;&nbsp;&nbsp; = case when a.isnullable=1 then '√'else '' 
end,<BR>&nbsp;&nbsp;&nbsp; 默认值&nbsp;&nbsp;&nbsp;&nbsp; = 
isnull(e.text,''),<BR>&nbsp;&nbsp;&nbsp; 字段说明&nbsp;&nbsp; = 
isnull(g.[value],'')<BR>FROM <BR>&nbsp;&nbsp;&nbsp; syscolumns a<BR>left join 
<BR>&nbsp;&nbsp;&nbsp; systypes b <BR>on <BR>&nbsp;&nbsp;&nbsp; 
a.xusertype=b.xusertype<BR>inner join <BR>&nbsp;&nbsp;&nbsp; sysobjects d <BR>on 
<BR>&nbsp;&nbsp;&nbsp; a.id=d.id&nbsp; and d.xtype='U' and&nbsp; 
d.name&lt;&gt;'dtproperties'<BR>left join <BR>&nbsp;&nbsp;&nbsp; syscomments e 
<BR>on <BR>&nbsp;&nbsp;&nbsp; a.cdefault=e.id<BR>left join 
<BR>sys.extended_properties&nbsp;&nbsp; g <BR>on <BR>&nbsp;&nbsp;&nbsp; 
a.id=G.major_id and a.colid=g.minor_id&nbsp; <BR>left 
join<BR>sys.extended_properties f<BR>on <BR>&nbsp;&nbsp;&nbsp; d.id=f.major_id 
and f.minor_id=0<BR>where <BR>&nbsp;&nbsp; d.name='zy04h'&nbsp;&nbsp;&nbsp; 
--如果只查询指定表,加上此where条件，tablename是要查询的表名；去除where条件查询所有的表信息<BR>order by 
<BR>&nbsp;&nbsp;&nbsp; a.id,a.colorder</P>  
</body>
</html>
